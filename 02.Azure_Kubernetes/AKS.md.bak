# ğŸš€ Azure Kubernetes Deployment Options

Azure provides multiple ways to deploy or manage Kubernetes clusters depending on your use case â€” whether you're a developer deploying an app or a cloud engineer managing hybrid clusters.

---

## ğŸ”¹ 1. Deploy Application (New)

Use this if:  
You already have a **Kubernetes cluster (AKS or Arc-connected)** and want to deploy an application quickly â€” without touching infrastructure.

### ğŸ§ª Real-World Scenario:
You're a developer who wants to deploy a containerized app from a **GitHub repo** to a **pre-existing AKS cluster** â€” similar to GKEâ€™s "deploy from marketplace" or "autopilot with app config."

### âœ… Key Points:

- ğŸš« No cluster creation needed
- ğŸ¯ Application-focused workflow
- ğŸ” Uses **GitOps** or **Bicep templates** under the hood
- ğŸ’¼ Great for DevOps teams

---

## ğŸ”¹ 2. Kubernetes Cluster

Use this if:  
You want **full control** over how the Kubernetes cluster is set up â€” including **VM size**, **node pools**, **networking**, **scaling**, and **monitoring**.

### ğŸ§ª Real-World Scenario:
You're an SRE or cloud engineer setting up a **production-grade AKS cluster** with custom VNet, autoscaling, multiple node pools, and integrations.

### âœ… Key Points:

- ğŸ”§ Full flexibility and control
- ğŸ“ˆ Ideal for **production** or **complex environments**
- ğŸ§  Requires more decisions (which is good for custom setups)
- ğŸš€ Most common choice for **serious workloads**

---

## ğŸ”¹ 3. Automatic Kubernetes Cluster (Preview)

Use this if:  
You want a **hands-off experience**, similar to **GKE Autopilot** â€” Azure handles the infrastructure.

### ğŸ§ª Real-World Scenario:
Youâ€™re prototyping or running a **dev/test environment** and want a quick, minimal-effort setup.

### âœ… Key Points:

- ğŸ§ª Still in **preview**
- ğŸ§˜â€â™‚ï¸ Minimal configuration; Azure manages infra
- ğŸ”„ Azure handles upgrades, autoscaling, and maintenance
- âš ï¸ Not recommended for **production workloads** yet

---

## ğŸ”¹ 4. Add a Kubernetes Cluster with Azure Arc

Use this if:  
You already have a Kubernetes cluster **outside Azure** (on-prem, AWS, GCP) and want to **manage it via Azure**.

### ğŸ§ª Real-World Scenario:
Your organization has Kubernetes clusters on-prem and wants **central governance, security, policy, and monitoring** via Azure.

### âœ… Key Points:

- ğŸ”— Registers existing clusters in Azure
- ğŸš« Does **not** create a new cluster
- ğŸŒ Ideal for **hybrid cloud** strategies
- ğŸ” Enables **Azure Policy, Defender for Kubernetes**, and more

---

## ğŸ”¹ 5. Create a Kubernetes Cluster with Azure Arc

Use this if:  
You want to **provision a Kubernetes cluster** on **non-Azure infrastructure** (e.g., your own data center or another cloud), but still manage it with Azure tooling.

### ğŸ§ª Real-World Scenario:
Youâ€™re building a hybrid or edge solution where the cluster runs **outside Azure**, but you want **Azure-native control and observability**.

### âœ… Key Points:

- ğŸ—ï¸ Provisions and connects cluster to Azure
- ğŸ§­ Fully **Azure Arc-enabled Kubernetes**
- ğŸŒ Extends Azureâ€™s capabilities to **on-prem and multi-cloud environments**

---

> ğŸ’¡ Choose the option that best matches your role and use case â€” from fast dev deployments to full production-grade or hybrid cloud clusters.


# âœ… Azure AKS Fundamentals: Subscription, Resource Groups & Node Pools

---

## âœ… 1. Subscription

### ğŸ“Œ What it is:
Your **billing account** in Azure.

Every resource (e.g., AKS cluster, VM, storage) must be associated with a **Subscription** to track:
- ğŸ’° Cost
- ğŸ“Š Usage
- ğŸ”’ Role-Based Access Control (RBAC)

---

## âœ… 2. Resource Group

### ğŸ“Œ What it is:
A **logical container** in Azure to **group related resources** together.

### ğŸ” Real-world Example:
You're building a shopping app â†’ you might create a resource group:


And group within it:
- AKS Cluster
- Load Balancer
- Azure Storage Account
- Azure Key Vault

### âœ… Benefits:
- ğŸ‘¥ Manage permissions at group level
- ğŸ§¹ Delete or clean up all resources in one go
- ğŸ“¦ Logical grouping for better organization

---

## âœ… 3. Cluster Preset Configuration (AKS)

### ğŸ“Œ What it is:
A **preset template** that lets you pick how much **control vs simplicity** you want while creating the AKS cluster.

### ğŸ§° Preset Types:

| Preset     | Use Case                       | Notes                                             |
|------------|--------------------------------|---------------------------------------------------|
| Dev/Test   | Learning, temporary testing     | Low cost, fewer nodes, simplified config          |
| Production | Critical services               | Autoscaling, multi-node pools, secure defaults    |
| Custom     | Advanced/pro users              | Full control over network, identity, VM sizes     |

### ğŸ” Real-world Scenario:

- âœ… For testing/demo â†’ choose **Dev/Test**
- âœ… For business-critical services â†’ go **Production** or **Custom**

> ğŸ’¡ **Tip:** If you're learning AKS, start with **Dev/Test** for quick setup.

---

# ğŸ§± What is a Node Pool in AKS?

### ğŸ“Œ Definition:
A **Node Pool** is a group of **VMs (nodes)** with the **same OS, size, and configuration**.

- You can run **Linux** and **Windows** pools in the same cluster.
- You can isolate different **workloads** using different pools.

---

## ğŸ”¹ System Node Pool â€” Why Itâ€™s Needed?

### ğŸ“Œ Purpose:
Runs **core Kubernetes and AKS components**, such as:

- `kube-proxy` â€” handles networking rules
- `CoreDNS` â€” provides internal cluster DNS
- `metrics-server` â€” provides resource metrics
- **AKS Add-ons**, including:
  - `azure-ip-masq-agent`
  - `kube-addon-manager`
  - `coredns-autoscaler`

### ğŸ’¡ Best Practices:

- Keep system node pool **small** (1â€“2 nodes).
- Use smaller VM sizes like `Standard_DS2_v2`.
- **Mark node pool as `type=system`** explicitly.

---

## ğŸ”¸ User Node Pool â€” Why It's Important?

### ğŸ“Œ Purpose:
Runs **your application workloads (Pods)**.

- You can have **multiple user pools** for different apps:
  - ğŸŒ Web apps
  - ğŸ§® Batch jobs
  - ğŸ§  ML workloads (GPU)
  - ğŸ’¾ Memory-heavy services

### ğŸ¯ Benefits:

- ğŸ”’ **Workload isolation**: System and app workloads are separated.
- ğŸ“ˆ **Scalability**: You can autoscale user pools independently.
- ğŸ’° **Cost optimization**: Use different VM sizes per workload type.

---

## ğŸ§  Summary

| Component         | Purpose                                            |
|------------------|----------------------------------------------------|
| Subscription      | Billing & access boundary                         |
| Resource Group    | Logical folder to group resources                 |
| Cluster Preset    | Simplifies AKS setup for common use cases         |
| System Node Pool  | Runs core Kubernetes and AKS system components    |
| User Node Pool    | Runs actual applications with isolated scaling    |

> âœ… Understanding these foundational concepts is key to mastering AKS in production.

---

## âœ… Best Practices: Node Pools in Azure Kubernetes Service (AKS)

---

### âš ï¸ Taint the System Node Pool (Highly Recommended)

To avoid scheduling your workloads on **system node pools**, **taint the nodes** to allow only critical AKS components:

```bash
kubectl taint nodes <node-name> CriticalAddonsOnly=true:NoSchedule
```
---

## ğŸ§  Why Separate Node Pools Matter

Separating **system** and **user** node pools in AKS is a best practice for improving resilience, security, and operational efficiency.

---

### âœ… Benefits of Separating Node Pools

1. **ğŸ› ï¸ Reliability**  
   - Prevents user application crashes or resource exhaustion from affecting critical system components like CoreDNS or kube-proxy.

2. **ğŸ” Security**  
   - Apply **RBAC**, **Network Security Groups (NSGs)**, **taints**, and **node selectors** separately on user/system pools.

3. **ğŸ’¸ Flexibility**  
   - Use **Spot VMs** or **different VM sizes** in user pools for cost savings and workload optimization.

4. **ğŸ“ˆ Scalability**  
   - **Independently autoscale** node pools based on specific workload patterns (e.g., API servers, ML jobs, batch tasks).

---

## ğŸ”§ How to Specify a Node Pool Type in Azure CLI

When creating node pools, specify whether it's a **System** or **User** pool using the `--mode` flag.

---

### ğŸ¯ System Node Pool Example

```bash
az aks nodepool add \
  --resource-group myResourceGroup \
  --cluster-name myAKSCluster \
  --name systempool \
  --mode System \
  --node-count 1 \
  --node-vm-size Standard_DS2_v2
```

### ğŸ‘©â€ğŸ’» User Node Pool Example
``` bash
az aks nodepool add \
  --resource-group myResourceGroup \
  --cluster-name myAKSCluster \
  --name userpool \
  --mode User \
  --node-count 3 \
  --node-vm-size Standard_D4s_v3 \
  --enable-cluster-autoscaler \
  --min-count 1 \
  --max-count 5

```
###ğŸ’¡ Use additional flags like --priority Spot for cost-optimized Spot instances in user pools.

---

## ğŸ’° AKS Spot Instances for User Node Pools

---

### ğŸ§  Why Use Spot Instances?

**Spot VMs** use Azureâ€™s unused compute capacity at **deeply discounted rates** â€” up to **90% cheaper** than regular VMs.

They're perfect for:
- ğŸ§ª Non-critical dev/test environments
- ğŸ§® Batch jobs or CI/CD runners
- ğŸ§  ML training tasks
- ğŸ” Event-driven workloads

---

### âš ï¸ Spot VM Behavior

- ğŸ’¸ **Cheaper**, but can be **evicted anytime** when Azure needs capacity.
- ğŸ§˜â€â™‚ï¸ Best suited for **interruptible** or **stateless** workloads.
- ğŸš« Not ideal for **mission-critical apps** requiring guaranteed uptime.

---

## ğŸ”§ How to Add a Spot Node Pool in AKS (Azure CLI)

```bash
az aks nodepool add \
  --resource-group myRG \
  --cluster-name myAKSCluster \
  --name spotpool \
  --mode User \
  --priority Spot \
  --spot-max-price -1 \
  --eviction-policy Delete \
  --node-count 1 \
  --node-vm-size Standard_D4s_v3
```